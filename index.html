<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Firebase Firestore Example</title>
    <script type="module">
        // Import Firebase SDK
        import { initializeApp } from "https://www.gstatic.com/firebasejs/9.23.0/firebase-app.js";
        import { getFirestore, collection, addDoc, getDocs } from "https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore.js";

        // Firebase configuration (replace with your config)
		  const firebaseConfig = {
			apiKey: "AIzaSyDAq4BF65YMUpN45JfW937Tw86jr3oQJms",
			authDomain: "losowanie-1d765.firebaseapp.com",
			projectId: "losowanie-1d765",
			storageBucket: "losowanie-1d765.firebasestorage.app",
			messagingSenderId: "954317941576",
			appId: "1:954317941576:web:2ebdfac2b525e2205be17d"
		  };

        // Initialize Firebase
        const app = initializeApp(firebaseConfig);
        const db = getFirestore(app);

        // Add data to Firestore
        async function addMessage(message) {
            try {
                const docRef = await addDoc(collection(db, "messages"), {
                    text: message,
                    timestamp: new Date()
                });
                console.log("Document written with ID: ", docRef.id);
                displayMessages(); // Refresh the message list
            } catch (e) {
                console.error("Error adding document: ", e);
            }
        }

        // Fetch and display data from Firestore
        async function displayMessages() {
            const messagesContainer = document.getElementById("messages");
            messagesContainer.innerHTML = ""; // Clear current messages
            const querySnapshot = await getDocs(collection(db, "messages"));
            querySnapshot.forEach((doc) => {
                const message = doc.data();
                const div = document.createElement("div");
                div.textContent = `${message.text} (Added on: ${message.timestamp.toDateString()})`;
                messagesContainer.appendChild(div);
            });
        }

        // Attach event listeners
        document.addEventListener("DOMContentLoaded", () => {
            document.getElementById("addMessageForm").addEventListener("submit", (e) => {
                e.preventDefault();
                const messageInput = document.getElementById("messageInput");
                if (messageInput.value.trim()) {
                    addMessage(messageInput.value.trim());
                    messageInput.value = ""; // Clear the input
                }
            });

            // Load messages on page load
            displayMessages();
        });
    </script>
</head>
<body>
    <h1>Firebase Firestore Web Example</h1>
    <form id="addMessageForm">
        <input type="text" id="messageInput" placeholder="Enter a message" required />
        <button type="submit">Add Message</button>
    </form>
    <h2>Messages:</h2>
    <div id="messages"></div>
</body>
</html>
